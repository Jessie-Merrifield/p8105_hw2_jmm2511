---
title: "p8105_hw2_jmm2511"
author: "Jessie Merrifield"
date: "2023-10-03"
output: github_document
---

```{r setup, message=FALSE}
library(tidyverse)
library(readxl)
```

## Question 1

Using datasets: pols-month.csv, unemployment.csv, and snp.csv.

*Goal*: 
merge these into a single data frame using year and month as keys across datasets.


1. Clean dataset pols_month

 Use separate() to break up the variable mon into integer variables year, month, and day; replace month number with month name; create a president variable taking values gop and dem, and remove prez_dem and prez_gop; and remove the day variable.

```{r clean pols_month}

#pols_month <- read_csv(file #="C:/Users/jmoon/OneDrive/Desktop/fivethirtyeight_datasets/pols-month.csv") %>% 
 # separate(mon, into=c("year", "month", "day"), convert = TRUE) %>% 
  #mutate(month = month.name[as.numeric(month)])%>% 
  #mutate(president=ifelse(prez_dem>0,"dem", "gop")) %>% 
  #select(-day, -prez_dem, -prez_gop)

#print(class(pols_month$month))

month_df = 
  tibble(
    month_num = 1:12,
    month_abb = month.abb,
    month = month.name
  )

pols_month = 
  read_csv("C:/Users/jmoon/OneDrive/Desktop/fivethirtyeight_datasets/pols-month.csv") |>
  separate(mon, into = c("year", "month_num", "day"), convert = TRUE) |>
  mutate(
    president = recode(prez_gop, "0" = "dem", "1" = "gop", "2" = "gop")) |>
  left_join(x = _, y = month_df) |> 
  select(year, month, everything(), -day, -starts_with("prez")) 
 
```

2. Clean dataset snp

clean the data in snp.csv using a similar process to the above. For consistency across datasets, arrange according to year and month, and organize so that year and month are the leading columns

```{r clean snp}

#snp <- read_csv(file ="C:/Users/jmoon/OneDrive/Desktop/fivethirtyeight_datasets/snp.csv")|>
 # separate(date, into=c("month", "day", "year"), convert = TRUE) |>
  #relocate(year, .before=month)|>
  #mutate(
   # year = if_else(year > 2023, year - 100, year))|> 
  #select(year, month, close) 

snp = 
  read_csv(
    "C:/Users/jmoon/OneDrive/Desktop/fivethirtyeight_datasets/snp.csv",
    col_types = cols(date = col_date(format = "%m/%d/%y"))) |>
  separate(date, into = c("year", "month_num", "day"), convert = TRUE) |>
  mutate(
    year = if_else(year > 2023, year - 100, year)) |> 
  left_join(x = _, y = month_df) |> 
  select(year, month, close) 

```


3. Clean dataset unemployment

tidy the unemployment data so that it can be merged with the previous datasets. This process will involve switching from “wide” to “long” format; ensuring that key variables have the same name; and ensuring that key variables take the same values

```{r clean unemployment}
month_df = 
  tibble(
    month_num = 1:12,
    month_abb = month.abb,
    month = month.name
  )

unemployment = 
  read_csv("C:/Users/jmoon/OneDrive/Desktop/fivethirtyeight_datasets/unemployment.csv") |>
  rename(year = Year) |>
  pivot_longer(
    Jan:Dec, 
    names_to = "month_abb",
    values_to = "unemployment"
  ) |> 
  left_join(x = _, y = month_df) |> 
  select(year, month, unemployment)

```


Finally, merge the datasets

Join the datasets by merging snp into pols, and merging unemployment into the result


- Explain briefly what each dataset contained

- describe the resulting dataset (e.g. give the dimension, range of years, and names of key variables).

Notice that there are some `NA` values in the `close` and `unemployment` variables, which indicate that the value of these variables is missing at those locations.




## Question 2

Read and clean Mr. Trash Wheel dataset

- specify the sheet in the Excel file and to omit non-data entries (rows with notes / figures; columns containing notes) using arguments in read_excel
- use reasonable variable names
- omit rows that do not include dumpster-specific data

Update the data to include a new homes_powered variable based on this calculation

```{r}
mr_trashwheel<-
  read_excel("C:/Users/jmoon/Downloads/202309 Trash Wheel Collection Data (1).xlsx",
             sheet="Mr. Trash Wheel",
             range = "A2:N586") %>% 
  janitor::clean_names() %>% 
  mutate(homes_powered=(weight_tons*(500/30))) %>%
  mutate(source="mr") %>% 
  mutate(year=as.numeric(year))

#584 observations of 15 variables

```


Use a similar process to import, clean, and organize the data for Professor Trash Wheel

```{r}
prof_trashwheel<-
  read_excel("C:/Users/jmoon/Downloads/202309 Trash Wheel Collection Data (1).xlsx",
             sheet="Professor Trash Wheel",
             range = "A2:M108") %>% 
  janitor::clean_names() %>% 
  mutate(homes_powered=(weight_tons*(500/30)))%>% 
  mutate(source="prof")

#106 observations of 14 variables

#216.26 tons total of trash collected

```


Use a similar process to import, clean, and organize the data for Gwynnda,

```{r}
g_trashwheel<-
  read_excel("C:/Users/jmoon/Downloads/202309 Trash Wheel Collection Data (1).xlsx",
             sheet="Gwynnda Trash Wheel",
             range = "A2:L157") %>% 
  janitor::clean_names() %>% 
  mutate(homes_powered=(weight_tons*(500/30)))%>% 
  mutate(source="gwynnda")

#155 observations of 13 variables

filter(g_trashwheel,year==2021, month=="July")

#16,3000 cigarette butts from July 2021

```


combine these with the Mr. Trash Wheel dataset to produce a single tidy dataset. To keep track of which Trash Wheel is which, you may need to add an additional variable to all datasets before combining.

```{r}
trashwheel_tidy = 
  bind_rows(mr_trashwheel, prof_trashwheel, g_trashwheel) %>% 
  relocate(source) %>% 
  separate(date, into=c("year1", "month1", "day"), convert = TRUE) %>% 
  select(-year1,-month1) %>% 
  relocate(day, .before=year)

#I chose to separate out the day because the date value felt redundant

#there are 845 observations with 15 variables

```


*Write a paragraph about these data; you are encouraged to use inline R.*

- note the number of observations in the resulting datasets


- give examples of key variables. 



- what was the total weight of trash collected by Professor Trash Wheel?
- What was the total number of cigarette butts collected by Gwynnda in July of 2021?


## Question 3

Import, clean, and tidy the dataset of baseline demographics. 

- Ensure that sex and APOE4 carrier status are appropriate encoded (i.e. not numeric)
- remove any participants who do not meet the stated inclusion criteria (i.e. no MCI at baseline).


- Discuss important steps in the import process and relevant features of the dataset. 

```{r}
baseline<-
  read.csv("C:/Users/jmoon/OneDrive/Desktop/data_mci/MCI_baseline.csv",
           skip = 1) %>% 
  janitor::clean_names() %>% 
  filter(age_at_onset !=".")


print(class(baseline$sex))
print(class(baseline$apoe4))


```

*How many participants were recruited, and of these how many develop MCI?*

*What is the average baseline age?* 

*What proportion of women in the study are APOE4 carriers?)*



import, clean, and tidy the dataset of longitudinally observed biomarker values; 

*comment on the steps on the import process and the features of the dataset.*

```{r}
biomarkers<-read.csv("C:/Users/jmoon/OneDrive/Desktop/data_mci/mci_amyloid.csv",
                     skip=1) %>% 
  janitor::clean_names()

```


*Check whether some participants appear in only the baseline or amyloid datasets, and comment on your findings.*



Combine the demographic and biomarker datasets so that only participants who appear in both datasets are retained

```{r}

```


*briefly describe the resulting dataset;*

export the result as a CSV to your data directory.

```{r}

```




